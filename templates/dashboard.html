{% extends "layout.html" %}
{% block body %}
<style type="text/css">
@import url(https://fonts.googleapis.com/css?family=Lato:400,700);
.admin-block
{
	min-height: 220px;
	padding-left: auto;
	padding-right: auto;
	border-radius: 6px;
	box-shadow: 0px 0px 2px 2px rgba(0,0,0,.15);
	margin: 20px 0px;
	padding: 20px;
	padding-top: 10px;
	padding-bottom: 10px;
	background-color: #f8f5f0;
	text-align: center;
	font-family: 'Lato', sans-serif;
}

.admin-block h1
{
	font-size: 63px;
}

.status-img
{
	margin-top: 20px;
	margin-bottom: 10px;
}
</style>
<div class="row">
	<div class="col-md-3">
		<div class="admin-block">
			<h1><strong>{{ vm_count }}</strong></h1>
			<h2>Virtual Machines</h2>
		</div>
	</div>
	<div class="col-md-3">
		<div class="admin-block">
			<h1><strong>{{ ci_count }}</strong></h1>
			<h2>ServiceNow CMDB Items</h2>
		</div>
	</div>
	<div class="col-md-3">
		<div class="admin-block">
			<h1><strong>{{ task_progress_count }}</strong></h1>
			<h2>Tasks In Progress</h2>
		</div>
	</div>
	<div class="col-md-3">
		<div class="admin-block">
			<h1><strong>{{ task_failed_count }}</strong></h1>
			<h2>Recently Failed Tasks</h2>
		</div>
	</div>
</div>
<div class="row">
	<div class="col-md-12">
		<div class="panel panel-default">
			<div class="panel-heading">My Recent Tasks</div>
			<div class="panel-body" style="padding:3px">
{%- if tasks and tasks|length > 0 %}
				<table class="table table-condensed table-striped" id="tasks" style="margin-bottom:0">
					<thead>
						<tr>
							<th>ID</th>
							<th>Module</th>
							<th>Start Time</th>
							<th>End Time</th>
							<th>Elapsed</th>
							<th>Status</th>
							<th></th>
						</tr>
					</thead>
					<tbody>
{%- for task in tasks %}
						<tr>
							<td>{{ task.id }}</td>
							<td>{% if task.description %}<abbr title="{{ task.description }}">{% endif %}{{ task.module }}{% if task.description %}</abbr>{% endif %}</td>
							<td>{{ task.start or '' }}</td>
							<td>{{ task.end or '' }}</td>
							<td>{% if task.end and task.start %}{{ task.end - task.start }}{% endif %}</td>
							<td>{% if task.status == 0 %}<span style="color:#22c">In Progress</span>{% elif task.status == 1 %}<span style="color:#2c2">Succeeded</span>{% elif task.status == 2 %}<span style="color:#c22">Failed</span>{% else %}Unknown{% endif %}</td>
							<td><a class="btn btn-xs btn-default" href="{{ url_for('task_status', id=task.id) }}"><i class="fa fa-fw fa-info"></i> Details</a></td>
						</tr>
{%- endfor %}
					</tbody>
				</table>
{%- else %}
				You have no tasks to show.
{%- endif %}

			</div>
		</div>
	</div>
</div>
{% endblock %}
